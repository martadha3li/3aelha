<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ</title>
    <style>
        :root { --ios-blue: #007AFF; --ios-bg: #F2F2F7; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: var(--ios-bg); padding: 20px; direction: rtl; }
        
        .card { background: white; border-radius: 15px; padding: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .setting-item { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 15px 0; border-bottom: 1px solid #eee; 
        }
        .setting-item:last-child { border-bottom: none; }
        .setting-info b { font-size: 16px; display: block; }
        .setting-info span { font-size: 12px; color: #888; }

        /* Ø³ØªØ§ÙŠÙ„ Ù…ÙØªØ§Ø­ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ iOS */
        .switch { position: relative; display: inline-block; width: 50px; height: 28px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { 
            position: absolute; cursor: pointer; inset: 0; background-color: #ccc; 
            transition: .4s; border-radius: 34px; 
        }
        .slider:before { 
            position: absolute; content: ""; height: 22px; width: 22px; 
            left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; 
        }
        input:checked + .slider { background-color: var(--ios-blue); }
        input:checked + .slider:before { transform: translateX(22px); }

        .back-btn { display: inline-block; margin-bottom: 15px; text-decoration: none; color: var(--ios-blue); font-weight: bold; }
    </style>
</head>
<body>

    <a href="admin.html" class="back-btn">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</a>
    <h2>Ø¥Ø¯Ø§Ø±Ø© Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ù†ØµØ©</h2>
    <p style="color:#666; font-size: 14px; margin-bottom: 20px;">ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ØªÙŠ ØªØ¸Ù‡Ø± Ù„Ù„Ø£Ø¹Ø¶Ø§Ø¡ ÙÙŠ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ:</p>

    <div class="card">
        <div class="setting-item">
            <div class="setting-info">
                <b>Ù‚Ø³Ù… Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© ğŸ’¬</b>
                <span>ØªÙØ¹ÙŠÙ„ Ø£Ùˆ ØªØ¹Ø·ÙŠÙ„ Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</span>
            </div>
            <label class="switch">
                <input type="checkbox" id="showChat" onchange="updateConfig('showChat', this.checked)">
                <span class="slider"></span>
            </label>
        </div>

        <div class="setting-item">
            <div class="setting-info">
                <b>Ù‚Ø³Ù… Ø§Ù„Ø£Ø¯Ø¹ÙŠØ© ğŸ“–</b>
                <span>Ø¹Ø±Ø¶ Ø£Ùˆ Ø¥Ø®ÙØ§Ø¡ Ø­ØµÙ† Ø§Ù„Ù…Ø³Ù„Ù… ÙˆØ§Ù„Ø£Ø¯Ø¹ÙŠØ©</span>
            </div>
            <label class="switch">
                <input type="checkbox" id="showDuas" onchange="updateConfig('showDuas', this.checked)">
                <span class="slider"></span>
            </label>
        </div>

        <div class="setting-item">
            <div class="setting-info">
                <b>Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø© ğŸ•Œ</b>
                <span>Ø¥Ø¸Ù‡Ø§Ø± Ø¬Ø¯ÙˆÙ„ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„ØµÙ„Ø§Ø©</span>
            </div>
            <label class="switch">
                <input type="checkbox" id="showPrayer" onchange="updateConfig('showPrayer', this.checked)">
                <span class="slider"></span>
            </label>
        </div>

        <div class="setting-item">
            <div class="setting-item">
                <div class="setting-info">
                    <b>Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª ğŸ†</b>
                    <span>ØªÙØ¹ÙŠÙ„ Ù‚Ø³Ù… Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª ÙˆØ§Ù„Ø¬ÙˆØ§Ø¦Ø²</span>
                </div>
                <label class="switch">
                    <input type="checkbox" id="showComps" onchange="updateConfig('showComps', this.checked)">
                    <span class="slider"></span>
                </label>
            </div>
        </div>
    </div>

    <script type="module">
        import { db } from './config.js';
        import { doc, getDoc, setDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const configDoc = doc(db, "Settings", "AppConfig");

        // Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
        async function loadSettings() {
            const snap = await getDoc(configDoc);
            if (snap.exists()) {
                const data = snap.data();
                document.getElementById('showChat').checked = data.showChat !== false;
                document.getElementById('showDuas').checked = data.showDuas !== false;
                document.getElementById('showPrayer').checked = data.showPrayer !== false;
                document.getElementById('showComps').checked = data.showComps !== false;
            } else {
                // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
                await setDoc(configDoc, { showChat: true, showDuas: true, showPrayer: true, showComps: true });
            }
        }

        // ØªØ­Ø¯ÙŠØ« Firestore Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø£ÙŠ Ù…ÙØªØ§Ø­
        window.updateConfig = async (field, value) => {
            try {
                await updateDoc(configDoc, { [field]: value });
                console.log(`${field} updated to ${value}`);
            } catch (e) {
                alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸");
            }
        };

        loadSettings();
    </script>
</body>
</html>
